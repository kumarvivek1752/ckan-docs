"use strict";(self.webpackChunkckan_docs=self.webpackChunkckan_docs||[]).push([[456],{6731:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>t,contentTitle:()=>r,default:()=>h,frontMatter:()=>i,metadata:()=>c,toc:()=>d});var a=s(5893),l=s(1151);const i={sidebarposition:2},r="Install CKAN with Package",c={id:"installation/install-with-package",title:"Install CKAN with Package",description:"In this section we will learn how to install CKAN with Package.",source:"@site/docs/installation/install-with-package.md",sourceDirName:"installation",slug:"/installation/install-with-package",permalink:"/ckan-docs/installation/install-with-package",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/installation/install-with-package.md",tags:[],version:"current",frontMatter:{sidebarposition:2},sidebar:"tutorialSidebar",previous:{title:"Install CKAN with Docker",permalink:"/ckan-docs/installation/install-with-docker"},next:{title:"Azure AD with CKAN",permalink:"/ckan-docs/category/azure-ad-with-ckan"}},t={},d=[{value:"What you&#39;ll need",id:"what-youll-need",level:3},{value:"CKAN Installation Guide on Ubuntu 20.04",id:"ckan-installation-guide-on-ubuntu-2004",level:3},{value:"Congratulations! You have successfully installed CKAN!\ud83d\udc4c",id:"congratulations-you-have-successfully-installed-ckan",level:3},{value:"Additional CKAN Setup Steps",id:"additional-ckan-setup-steps",level:3},{value:"Note: You can also refer old docs for installation of CKAN with Package here",id:"note-you-can-also-refer-old-docs-for-installation-of-ckan-with-package-here",level:3}];function o(e){const n={a:"a",code:"code",h1:"h1",h3:"h3",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,l.a)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.h1,{id:"install-ckan-with-package",children:"Install CKAN with Package"}),"\n",(0,a.jsx)(n.p,{children:"In this section we will learn how to install CKAN with Package."}),"\n",(0,a.jsx)(n.h3,{id:"what-youll-need",children:"What you'll need"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.a,{href:"https://ubuntu.com/download/server",children:"ubunutu"})," version 20.4"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.a,{href:"https://docs.ckan.org/en/latest/maintaining/installing/index.html#package-install",children:"CKAN DOCS"})," official docs."]}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"ckan-installation-guide-on-ubuntu-2004",children:"CKAN Installation Guide on Ubuntu 20.04"}),"\n",(0,a.jsx)(n.p,{children:"Follow these steps to install CKAN on Ubuntu 20.04:"}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsxs)(n.li,{children:["Login in as root user. If this is your first time, you will need to create a root password:","\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"sudo passwd root\n"})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["Login as root user, enter password when prompted:","\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"sudo -i\n"})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["Update ubuntu package index:","\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"sudo apt update\n"})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["Install Ubuntu required packages for CKAN:","\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"sudo apt install -y libpq5 redis-server nginx supervisor\n"})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["Download CKAN package. In this guide we are installing CKAN for Python 3:","\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"wget https://packaging.ckan.org/python-ckan_2.9-py3-focal_amd64.deb\n"})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["Install additional needed packages:","\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"python3 --version\r\nsudo apt-get install python3.8-distutils\n"})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["Install CKAN package:","\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"sudo dpkg -i python-ckan_2.9-py3-focal_amd64.deb\n"})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["Install PostgreSQL:","\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"sudo apt install -y postgresql\n"})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["Check that it installed correctly by running the following command and ensuring that the encoding of databases is UTF8:","\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"sudo -u postgres psql -l\n"})}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(n.ol,{start:"10",children:["\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:["Create a database user and create a password for the new user when prompted, replace ",(0,a.jsx)(n.code,{children:"username"})," with the username of your choice:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"sudo -u postgres createuser -S -D -R -P username\n"})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:["Create a new PostgreSQL database owned by the new user, replace ",(0,a.jsx)(n.code,{children:"ckan_default"})," with a database name of your choice and ",(0,a.jsx)(n.code,{children:"username"})," with the username of the user just created:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"sudo -u postgres createdb -O username ckan_default -E utf-8\n"})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"If you do not have vim installed you will need to install it with the following:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"apt install vim\n"})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"Edit the CKAN configuration file and fill in the password, database, and database user for the database you\u2019ve created:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"vim /etc/ckan/default/ckan.ini\n"})}),"\n",(0,a.jsx)(n.p,{children:"In this example our information is as follows:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["Username: ",(0,a.jsx)(n.code,{children:"ckanuser"})]}),"\n",(0,a.jsxs)(n.li,{children:["Password: ",(0,a.jsx)(n.code,{children:"password"})]}),"\n",(0,a.jsxs)(n.li,{children:["Database Name: ",(0,a.jsx)(n.code,{children:"ckan_default"})]}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"Install Solr:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"sudo apt install -y solr-tomcat\n"})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"Change the default port Tomcat runs on to the one expected by CKAN:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"vim /etc/tomcat9/server.xml\n"})}),"\n",(0,a.jsx)(n.p,{children:"Edit the following line:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-xml",children:'<Connector port="8080" protocol="HTTP/1.1"\n'})}),"\n",(0,a.jsx)(n.p,{children:"To:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-xml",children:'<Connector port="8983" protocol="HTTP/1.1"\n'})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:["Replace the default ",(0,a.jsx)(n.code,{children:"schema.xml"})," file with a symlink to the CKAN schema file:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"sudo mv /etc/solr/conf/schema.xml /etc/solr/conf/schema.xml.bak\r\nsudo ln -s /usr/lib/ckan/default/src/ckan/ckan/config/solr/schema.xml /etc/solr/conf/schema.xml\n"})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"Restart Solr:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"sudo service tomcat9 restart\n"})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"Check that Solr is running by entering the following into your browser:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"http://localhost:8983/solr/\n"})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:["Edit the ",(0,a.jsx)(n.code,{children:"solr_url"})," line in the CKAN configuration file to go to your Solr server:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"vim /etc/ckan/default/ckan.ini\n"})}),"\n",(0,a.jsx)(n.p,{children:"Example:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"solr_url = http://127.0.0.1:8983/solr\n"})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"Also edit the following options in the CKAN configuration File:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.code,{children:"site_id=ckan_default"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.code,{children:"site_url=http://localhost"})}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"Initialize CKAN database by running the following command:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"sudo ckan db init\n"})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"Reload the Supervisor daemon so the new processes are picked up:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"sudo supervisorctl reload\n"})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"Check the status of the processes:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"sudo supervisorctl status\n"})}),"\n",(0,a.jsx)(n.p,{children:"The following should appear with no errors:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"ckan-datapusher:ckan-datapusher-00   RUNNING   pid 1963, uptime 0:00:12\r\nckan-uwsgi:ckan-uwsgi-00             RUNNING   pid 1964, uptime 0:00:12\r\nckan-worker:ckan-worker-00           RUNNING   pid 1965, uptime 0:00:12\n"})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"Restart Nginx:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"sudo service nginx restart\n"})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"Enter the following into your web browser and the CKAN front page should appear:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"http://localhost/\n"})}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"congratulations-you-have-successfully-installed-ckan",children:"Congratulations! You have successfully installed CKAN!\ud83d\udc4c"}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h3,{id:"additional-ckan-setup-steps",children:"Additional CKAN Setup Steps"}),"\n",(0,a.jsx)(n.p,{children:"Follow these steps to create a super user, setup file uploads, activate the CKAN virtual environment, and update the dataproxy timeout:"}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:["To create a super user in CKAN, run the following command, replacing ",(0,a.jsx)(n.code,{children:"username"}),", ",(0,a.jsx)(n.code,{children:"email@gmail.com"}),", and ",(0,a.jsx)(n.code,{children:"name"})," with your desired values:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"ckan -c /etc/ckan/default/ckan.ini sysadmin add username email=email@gmail.com name=name\n"})}),"\n",(0,a.jsx)(n.p,{children:"Example:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"ckan -c /etc/ckan/default/ckan.ini sysadmin add vivek email=vivek2292@gmail.com name=vivek\n"})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"To setup CKAN\u2019s FileStore with local file storage:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["Create the directory where CKAN will store uploaded files:","\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"sudo mkdir -p /var/lib/ckan/default\n"})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["Add the following line to your CKAN config file, after the ",(0,a.jsx)(n.code,{children:"[app:main]"})," line:","\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"ckan.storage_path = /var/lib/ckan/default\n"})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["Set the permissions of your ",(0,a.jsx)(n.code,{children:"ckan.storage_path"})," directory. For example if you\u2019re running CKAN with Nginx, then the Nginx\u2019s user (",(0,a.jsx)(n.code,{children:"www-data"})," on Ubuntu) must have read, write and execute permissions for the ",(0,a.jsx)(n.code,{children:"ckan.storage_path"}),":","\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"sudo chown www-data /var/lib/ckan/default\r\nsudo chmod u+rwx /var/lib/ckan/default\n"})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["Restart your web server, for example to restart uWSGI on a package install:","\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"sudo supervisorctl restart ckan-uwsgi:*\n"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"To activate the CKAN virtual environment:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:". /usr/lib/ckan/default/bin/activate\n"})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"To update the dataproxy timeout:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["Open the ",(0,a.jsx)(n.code,{children:"recline_view.js"})," file:","\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"vim /usr/lib/ckan/default/src/ckan/ckanext/reclineview/theme/public/recline_view.js\n"})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["Update the following line:","\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-javascript",children:"recline.Backend.DataProxy.timeout = 100000;\n"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(n.h3,{id:"note-you-can-also-refer-old-docs-for-installation-of-ckan-with-package-here",children:["Note: You can also refer old docs for installation of CKAN with Package ",(0,a.jsx)(n.a,{href:"https://docs.google.com/document/d/1cSkR2OCX70mh3GPKUs8st07mKQiFZJFay55MVyNy0DA/edit?usp=sharing",children:"here"})]})]})}function h(e={}){const{wrapper:n}={...(0,l.a)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(o,{...e})}):o(e)}},1151:(e,n,s)=>{s.d(n,{Z:()=>c,a:()=>r});var a=s(7294);const l={},i=a.createContext(l);function r(e){const n=a.useContext(i);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:r(e.components),a.createElement(i.Provider,{value:n},e.children)}}}]);