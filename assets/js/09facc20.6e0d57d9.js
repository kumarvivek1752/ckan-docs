"use strict";(self.webpackChunkckan_docs=self.webpackChunkckan_docs||[]).push([[428],{6922:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>a,contentTitle:()=>l,default:()=>h,frontMatter:()=>r,metadata:()=>s,toc:()=>c});var o=i(5893),t=i(1151);const r={sidebar_position:1},l="install Azure AD and configure on CKAN",s={id:"azure-AD/Installation",title:"install Azure AD and configure on CKAN",description:"You have just learned the How to install CKAN",source:"@site/docs/azure-AD/Installation.md",sourceDirName:"azure-AD",slug:"/azure-AD/Installation",permalink:"/ckan-docs/azure-AD/Installation",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/azure-AD/Installation.md",tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1},sidebar:"tutorialSidebar",previous:{title:"Azure AD with CKAN",permalink:"/ckan-docs/category/azure-ad-with-ckan"},next:{title:"Harvester with CKAN",permalink:"/ckan-docs/category/harvester-with-ckan"}},a={},c=[{value:"in this section we will learn how to install Azure AD on CKAN",id:"in-this-section-we-will-learn-how-to-install-azure-ad-on-ckan",level:2},{value:"What you&#39;ll need",id:"what-youll-need",level:3},{value:"Installation",id:"installation",level:2},{value:"if you are using docker",id:"if-you-are-using-docker",level:2},{value:"Configuration",id:"configuration",level:3}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.a)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.h1,{id:"install-azure-ad-and-configure-on-ckan",children:"install Azure AD and configure on CKAN"}),"\n",(0,o.jsxs)(n.p,{children:["You have just learned the ",(0,o.jsx)(n.strong,{children:"How to install CKAN"})]}),"\n",(0,o.jsx)(n.h2,{id:"in-this-section-we-will-learn-how-to-install-azure-ad-on-ckan",children:"in this section we will learn how to install Azure AD on CKAN"}),"\n",(0,o.jsx)(n.h3,{id:"what-youll-need",children:"What you'll need"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.a,{href:"https://docs.ckan.org/en/2.9/maintaining/installing/index.html",children:"CKAN"})," version 2.9 or above:"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.a,{href:"https://docs.microsoft.com/en-us/azure/active-directory/develop/quickstart-register-app",children:"Azure AD"})," version 2.0 or above:"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.a,{href:"https://github.com/ongov/ckanext-msal.git",children:"ckan-msal"})," compatible with CKAN 2.9.6 and CKAN 2.9.7"]}),"\n"]}),"\n",(0,o.jsx)(n.hr,{}),"\n",(0,o.jsx)(n.h2,{id:"installation",children:"Installation"}),"\n",(0,o.jsx)(n.p,{children:"To install ckanext-msal:"}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsx)(n.p,{children:"Activate your CKAN virtual environment, for example::"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:" . /usr/lib/ckan/default/bin/activate\n"})}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsx)(n.p,{children:"Install the ckanext-msal Python package into your virtual environment::"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"git clone https://github.com/boykoc/ckanext-msal.git\r\ncd ckanext-msal/\r\npython setup.py develop\r\npip install -r requirements.txt\n"})}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:["Add ",(0,o.jsx)(n.code,{children:"msal"})," to the ",(0,o.jsx)(n.code,{children:"ckan.plugins"})," setting in your CKAN\r\nconfig file (by default the config file is located at\r\n",(0,o.jsx)(n.code,{children:"/etc/ckan/default/production.ini"}),")."]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:["Edit ",(0,o.jsx)(n.code,{children:"msal_config.py <https://github.com/ongov/ckanext-msal/blob/ckan_2.9.7_compatible/ckanext/msal/msal_config.py>"}),"_ and replace the generic values with your specific credentials."]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsx)(n.p,{children:"Restart CKAN. For example if you've deployed CKAN on Ubuntu::"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"sudo service supervisor restart\n"})}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(n.hr,{}),"\n",(0,o.jsx)(n.h2,{id:"if-you-are-using-docker",children:"if you are using docker"}),"\n",(0,o.jsxs)(n.p,{children:["copy paste below code in your docker file and add ",(0,o.jsx)(n.code,{children:"msal"})," in .env file"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"### Msal ###\r\nRUN  pip3 install -e git+https://github.com/ongov/ckanext-msal.git#egg=ckanext-msal\r\n\r\nCOPY msal_config.py ${APP_DIR}/src/ckanext-msal/ckanext/msal/msal_config.py\r\n\n"})}),"\n",(0,o.jsx)(n.p,{children:"then"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"docker compose -f docker-compose.yml build --no-cache\r\ndocker compose -f docker-compose.yml up -d\n"})}),"\n",(0,o.jsx)(n.h3,{id:"configuration",children:"Configuration"}),"\n",(0,o.jsxs)(n.p,{children:["your ",(0,o.jsx)(n.code,{children:"msal_config.py"})," should look like this"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:'# MSAL configurations.\r\nAUTHORITY = "https://login.microsoftonline.com/d0139cb0-61c2-7362-9vf8c-e229cdf0fbed"\r\nCLIENT_ID = "5b040eb5-a574-8464-c489bc25580d"\r\nSCOPE = ["User.ReadBasic.All"]\r\nREDIRECT_URI = "http://localhost:5000/getAToken"\r\nCLIENT_SECRET = "P6D8Q~jhdsuhftIqZJs7N.k~EEOl~-axC"\r\n\r\n# Plugin specific configurations.\r\nEMAIL_DOMAINS = ["google.com","manishacharyagmail.onmicrosoft.com"]\r\n\r\n\n'})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["AUTHORITY: The authority URL for your tenant. For example: ",(0,o.jsx)(n.a,{href:"https://login.microsoftonline.com/your-tenant-name.onmicrosoft.com",children:"https://login.microsoftonline.com/your-tenant-name.onmicrosoft.com"})]}),"\n",(0,o.jsx)(n.li,{children:"CLIENT_ID: The application ID of your app registered in Azure AD."}),"\n",(0,o.jsx)(n.li,{children:'SCOPE: The scopes required by your app. For example: ["User.ReadBasic.All"].'}),"\n",(0,o.jsxs)(n.li,{children:["REDIRECT_URI: The redirect URI of your app. For example: ",(0,o.jsx)(n.a,{href:"http://localhost:5000/getAToken",children:"http://localhost:5000/getAToken"}),"."]}),"\n",(0,o.jsx)(n.li,{children:"CLIENT_SECRET: The client secret of your app."}),"\n",(0,o.jsx)(n.li,{children:'EMAIL_DOMAINS: The list of email domains that are allowed to access CKAN. For example: ["google.com"].'}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.a)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}},1151:(e,n,i)=>{i.d(n,{Z:()=>s,a:()=>l});var o=i(7294);const t={},r=o.createContext(t);function l(e){const n=o.useContext(r);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),o.createElement(r.Provider,{value:n},e.children)}}}]);